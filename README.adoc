= Filame - Arch Linux Configuration Manager

A powerful terminal tool for managing Arch Linux configurations across multiple devices with integrated GitHub repository syncing and ignore patterns support. Built with Varabyte's Kotter for a beautiful terminal UI.

== Overview

Filame helps you:

- *Sync configurations* across multiple Arch Linux devices
- *Track dotfiles* and system configurations in a centralized location
- *Integrate with GitHub* for version control and backup
- *Manage packages* from official repos and AUR with paru support
- *Auto-install packages* with configurations for a complete setup
- *Manage ignore patterns* to exclude sensitive or unnecessary files
- *Beautiful terminal UI* powered by Kotter with color-coded output

== Features

‚ú® *Device Management* - Configure unique device names for each system
üîÑ *Bidirectional Sync* - Export local configs to repo or import from repo
üåê *GitHub Integration* - Pull and push changes with full Git support
üìã *Configuration Tracking* - Track any file or directory on your system
üì¶ *Package Management* - Track, install, and manage official and AUR packages
üõ†Ô∏è *Paru Support* - Auto-install paru AUR helper when needed
üö´ *Ignore Patterns* - Exclude files with glob patterns
üé® *Terminal UI* - Beautiful color-coded interface using Kotter
üîß *Mock Mode* - Run in non-Linux environments for testing and development
‚ÜîÔ∏è *Two-Way Sync* - Automatically sync package metadata to/from GitHub repo

== Prerequisites

- Java 21 or higher
- Kotlin 2.2.20
- Git
- Arch Linux (or any Linux distribution with pacman)
- **Note:** Can run in mock mode on any OS (macOS, Windows, etc.) for testing

== Installation

1. Clone this repository:
+
[source,bash]
----
git clone https://github.com/OmyDaGreat/Filame.git
cd Filame
----

2. Build the project:
+
[source,bash]
----
./gradlew build
----

3. Run the application:
+
[source,bash]
----
./gradlew run
----

== Quick Start Guide

=== First Time Setup

1. Run Filame for the first time:
+
[source,bash]
----
./gradlew run
----

2. Select option *1. Configure settings*

3. Enter your device name (e.g., "arch-laptop")

4. Enter your GitHub repository URL (e.g., "https://github.com/username/dotfiles.git")

=== Setting Up Package Bundles

1. From the main menu, select *4. Add/Edit package bundle*

2. Enter the package name (e.g., `vim`)

3. Enter the source: `official` or `aur`

4. Enter an optional description

5. Choose whether to add configuration files (y/n)

6. If yes, enter source and destination paths for each config file

=== Discovering Packages from GitHub Repo

1. Create package directories in your GitHub repo (e.g., `vim/`, `i3/`)

2. Place config files in each directory

3. Optionally create a `package.yaml` in each directory with metadata

4. Select *2. Scan repo for packages*

5. Filame will automatically discover and track all packages

=== Installing Packages

*To install a single package with its configuration:*
- Select *5. Install package & apply config*
- Choose the package number from the list
- Filame will install the package and apply its configuration files

*To install all missing packages:*
- Select *6. Install all missing packages*
- Filame will install all tracked packages that aren't on the system

=== Syncing with GitHub

*To pull latest changes:*
- Select *9. Sync with GitHub*
- Choose option 1 to pull
- Then use option 2 to scan for new packages

*To push your changes:*
- First, export package configs (option 8)
- Select *9. Sync with GitHub*
- Choose option 2 to push
- Enter a commit message

=== Managing Package Bundles

Filame now uses **Package Bundles** as the primary entity. Each bundle contains:
- A package (from official repos or AUR)
- Associated configuration files
- Package metadata (name, source, description)

1. *Scan repo for packages* (option 2) - Automatically discover packages from your GitHub repo
2. *List package bundles* (option 3) - View all tracked packages with installation status
3. *Add/Edit package bundle* (option 4) - Manually create or update a package bundle
4. *Install package & apply config* (option 5) - Install a specific package and apply its configs
5. *Install all missing packages* (option 6) - Install all tracked packages that aren't on the system
6. *Update all packages* (option 7) - Update system packages (official + AUR)
7. *Export package configs* (option 8) - Export all package configurations to repo
8. *Sync with GitHub* (option 9) - Pull or push changes

== Configuration File

Filame stores its configuration in `~/.config/filame/config.yaml`

Example configuration with package bundles:
[source,yaml]
----
deviceName: arch-laptop
githubRepo: https://github.com/username/dotfiles.git
packageBundles:
  - name: vim
    source: official
    description: Text editor
    configFiles:
      - sourcePath: /home/user/.vimrc
        destinationPath: vim/.vimrc
        description: Vim configuration
  - name: i3
    source: official
    description: Tiling window manager
    configFiles:
      - sourcePath: /home/user/.config/i3/config
        destinationPath: i3/config
        description: Main i3 config
      - sourcePath: /home/user/.config/i3/status.conf
        destinationPath: i3/status.conf
        description: Status bar config
  - name: spotify
    source: aur
    description: Music streaming client
ignorePatterns:
  - "*.log"
  - "*.tmp"
  - ".cache/*"
  - "*.lock"
----

== Usage Examples

=== Tracking Common Dotfiles

Add these common Arch Linux configuration files:

[source]
----
Source: ~/.config/i3/config          ‚Üí Destination: i3/config
Source: ~/.config/polybar/config     ‚Üí Destination: polybar/config
Source: ~/.bashrc                    ‚Üí Destination: bashrc
Source: ~/.zshrc                     ‚Üí Destination: zshrc
Source: ~/.vimrc                     ‚Üí Destination: vimrc
Source: /etc/pacman.conf            ‚Üí Destination: pacman.conf
----

=== Setting Up Multiple Devices

1. On your first device, configure Filame and add your config files

2. Export configs and push to GitHub

3. On your second device, configure Filame with the same GitHub repo

4. Pull from GitHub to get the latest configs

5. Import configs to apply them to the new device

== Building and Development

=== Build the project:
[source,bash]
----
./gradlew build
----

=== Run tests:
[source,bash]
----
./gradlew test
----

=== Create a distribution:
[source,bash]
----
./gradlew distZip
----

The distribution will be created in `app/build/distributions/`

== Technical Details

*Built with:*
- Kotlin 2.2.20
- Varabyte's Kotter 1.1.2 for terminal UI
- JGit 6.10.0 for Git operations
- Kotlinx Serialization for configuration
- KAML for YAML parsing

== Roadmap

- [x] Support for package management (official and AUR)
- [x] Paru AUR helper integration
- [x] Mock mode for non-Linux environments
- [x] Two-way sync of package metadata
- [ ] Support for encrypted sensitive files
- [ ] Automatic backup before applying changes
- [ ] Diff viewer before importing configs
- [ ] Template system for config files
- [ ] Support for multiple GitHub repositories
- [ ] Interactive file browser
- [ ] Configuration profiles
== Mock Mode for Non-Linux Systems

Filame can run in mock mode on non-Linux systems (macOS, Windows, etc.) or in CI/CD environments. Mock mode simulates package operations while keeping all configuration and Git functionality intact.

=== Automatic Detection

Filame automatically enables mock mode when it detects a non-Linux operating system:

[source,bash]
----
./gradlew run
# Output: Non-Linux system detected. Enabling mock mode for package operations.
----

=== Manual Configuration

Enable or disable mock mode through settings:

1. Select "1. Configure settings"
2. Answer "y" to enable or "n" to disable mock mode

=== What Works in Mock Mode

‚úì Configuration tracking and management +
‚úì GitHub integration (pull/push) +
‚úì Package bundle management +
‚úì Package metadata export/import +
‚úì Two-way sync with repository +
‚úì File operations

=== What's Simulated in Mock Mode

‚ö† Package installation (displays what would be installed) +
‚ö† Package removal (displays what would be removed) +
‚ö† Package updates (displays update operations) +
‚ö† Package status checks (always shows as not installed)

For detailed information, see link:MOCK_MODE.md[Mock Mode Guide].

== Two-Way Configuration Sync

Filame now automatically syncs package bundle metadata between your local configuration and the GitHub repository:

=== From Local ‚Üí Repo (Export)

When you add or edit a package bundle:

1. Bundle is saved to `~/.config/filame/config.yaml`
2. Metadata is automatically exported to `<package-name>/package.yaml` in the repo

Example:
[source,bash]
----
‚úì Package bundle added successfully!
‚úì Package metadata exported to repo: vim/package.yaml
----

=== From Repo ‚Üí Local (Import)

When you scan the repository (option 2):

1. Filame discovers all package directories
2. Loads `package.yaml` metadata files
3. Updates local config with discovered packages

This enables seamless synchronization across multiple devices.

== Troubleshooting

=== Git Authentication Issues

If you encounter authentication issues when pushing to GitHub:

1. *Using SSH:* Make sure you have an SSH key set up and added to your GitHub account
+
[source,bash]
----
ssh-keygen -t ed25519 -C "your_email@example.com"
ssh-add ~/.ssh/id_ed25519
----

2. *Using HTTPS:* Configure Git credentials or use a personal access token
+
[source,bash]
----
git config --global credential.helper store
----

3. Use SSH URLs instead of HTTPS for better authentication

=== Configuration Not Saving

Make sure you have write permissions to `~/.config/filame/`

[source,bash]
----
mkdir -p ~/.config/filame
chmod 755 ~/.config/filame
----

=== Repository Clone Failures

Ensure the GitHub repository URL is correct and you have access to it. For private repositories, make sure your Git credentials are configured.

== Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'feat: Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

== Commit Message Convention

This project uses a customizable commit convention defined in `.kommit.yaml`:

- feat: A new feature
- fix: A bug fix
- docs: Documentation only changes
- chore: Other changes

== License

This project is licensed under the MIT License. See the LICENSE file for details.

== Acknowledgments

- Built with ‚ù§Ô∏è for the Arch Linux community
- Powered by https://github.com/varabyte/kotter[Varabyte's Kotter] for terminal UI
- Uses https://www.eclipse.org/jgit/[JGit] for Git operations

== Author

Om Gupta (@OmyDaGreat)